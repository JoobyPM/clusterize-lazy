<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Clusterize-Lazy basic demo</title>
  <style>
    #scroll {
      height: 240px;
      overflow: auto;
      border: 1px solid #ccc;
      font-family: sans-serif;
    }
    .skeleton {
      background: linear-gradient(90deg,#eee 25%,#ddd 37%,#eee 63%);
      background-size: 400% 100%;
      animation: shimmer 1.2s infinite;
    }
    @keyframes shimmer {
      0% { background-position: -400px 0; }
      100% { background-position: 400px 0; }
    }
  </style>
</head>
<body>
  <h1>Clusterize-Lazy basic demo</h1>

  <div id="scroll">
    <div id="content"></div>
  </div>

  <script type="module">
    import Clusterize from "../src/clusterize-lazy.js";

    const TOTAL = 1000;
    const PAGE = 40;

    async function fakeFetch(offset, size = PAGE) {
      await new Promise(r => setTimeout(r, 300));           // simulate latency
      const remaining = Math.max(0, TOTAL - offset);
      const take = Math.min(size, remaining);
      return Array.from({ length: take }, () => ({
        name: crypto.randomUUID().slice(0, 8)
      }));
    }

    const cluster = new Clusterize({
      rowHeight: 28,
      scrollElem: document.getElementById("scroll"),
      contentElem: document.getElementById("content"),

      fetchOnInit: async () => ({
        totalRows: TOTAL,
        rows: await fakeFetch(0)
      }),

      fetchOnScroll: fakeFetch,

      renderSkeletonRow: h =>
        '<div class="skeleton" style="height:' + h + 'px"></div>',

      renderRaw: (idx, data) =>
        '<div>' + (idx + 1) + '. ' + data.name + '</div>'
    });

    // expose for manual debugging in the console
    window.cluster = cluster;
  </script>
</body>
</html>
